<div
    [ngClass]="{ 'own-message': isOwnMessage, 'other-message': !isOwnMessage }"
    (mouseenter)="toggleHovered(true)"
    (mouseleave)="toggleHovered(false)"
    class="message-container"
>
    <img [src]="message.sender.photoURL" alt="assets/img/avatars/av-04.svg"/>
    <div class="message-content-container">
        <div class="author-container">
            <span (click)="handleProfileCard(true)" class="author-name">{{
                    message.sender.userName
                }}</span>
            <span class="message-time">{{ message.time }} Uhr</span>
        </div>

        <div class="message">{{ message.text }}</div>
        <div *ngIf="message.reactions && message.reactions.length > 0" class="reactions-container">
            <div *ngFor="let group of groupedReactions" class="reaction"
                 [class.user-reacted]="hasUserReacted(group.emoji)"
                 (click)="handleEmojiReaction(group.emoji, message)">
                <span class="emoji">{{ group.emoji }}</span>
                <span class="count">{{ group.count }}</span>
            </div>
        </div>

        @if (message.hasThread) {
            <div class="replies-container">
            <span (click)="openThread()" class="replies"
            >{{ message.threadAnswerCount }} @if (message.threadAnswerCount
            === 1) {
                Answer
            } @else {
                Answers
            }</span
            >
                <span class="last-reply"
                >Last Answer {{ message.threadLastTime }}</span
                >
            </div>
        }
    </div>
    <div class="chat-message-other">
        <div class="message-header">
            <span class="sender"></span>
            <span class="timestamp"></span>
        </div>
    </div>

    <div>
        <app-chat-option-bar
            [message]="message"
            [isOwnMessage]="isOwnMessage"
            [emojiList]="emojiList"
            (chosenEmoji)="handleEmojiReaction($event, message)">
            >
        </app-chat-option-bar>
    </div>
</div>
